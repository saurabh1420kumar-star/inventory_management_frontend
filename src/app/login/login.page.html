<ion-content class="ion-padding">
  <div class="login-wrapper">
    <ion-card class="login-card">
      <ion-card-header class="ion-text-center">
        <div class="logo-wrapper">
          <ion-avatar class="logo-avatar">
              <ion-icon name="cube-outline"></ion-icon>
          </ion-avatar>
        </div>
        <ion-card-title class="app-title">Nectar</ion-card-title>
        <ion-card-subtitle class="app-subtitle">
          Inventory Management System
        </ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">

          <!-- Username -->
          <ion-item>
            <ion-label position="stacked">Username</ion-label>
            <ion-input
              type="text"
              placeholder="Enter your username"
              formControlName="username"
              required
            ></ion-input>
          </ion-item>

          <!-- validation message -->
          <p *ngIf="loginForm.controls['username'].touched && loginForm.controls['username'].invalid"
             class="error-text">
            Username is required
          </p>

          <!-- Password -->
          <ion-item>
            <ion-label position="stacked">Password</ion-label>
            <div class="password-row">
              <ion-input
                [type]="showPassword ? 'text' : 'password'"
                placeholder="••••••••"
                formControlName="password"
                required
              ></ion-input>

              <ion-button
                fill="clear"
                size="small"
                type="button"
                (click)="togglePasswordVisibility()"
              >
                <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
              </ion-button>
            </div>
          </ion-item>

          <!-- validation message -->
          <p *ngIf="loginForm.controls['password'].touched && loginForm.controls['password'].invalid"
             class="error-text">
            Password is required
          </p>

          <!-- Forgot password -->
          <div class="forgot-wrapper">
            <button type="button" class="link-button" (click)="forgotPassword()">
              Forgot password?
            </button>
          </div>

          <!-- Login Button -->
          <div class="submit-wrapper">
            <ion-button
              expand="block"
              size="large"
              type="submit"
              [disabled]="loginForm.invalid || loading"
            >
              <ng-container *ngIf="loading; else showText">
                <ion-spinner name="crescent" slot="start"></ion-spinner>
                Signing in...
              </ng-container>

              <ng-template #showText>
                Sign In
              </ng-template>

            </ion-button>
          </div>

          <!-- Signup link -->
          <div class="signup-text">
            <span>Don't have an account?</span>
            <button type="button" class="link-button" (click)="goToSignup()">
              Create one
            </button>
          </div>

        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
